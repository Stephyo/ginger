<!DOCTYPE html>

<html lang="en-US">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="assets/fonts/font-awesome.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.css" type="text/css">
    <link rel="stylesheet" href="assets/css/bootstrap-select.min.css" type="text/css">
    <link rel="stylesheet" href="assets/css/owl.carousel.css" type="text/css">
    <link rel="stylesheet" href="assets/css/jquery.mCustomScrollbar.css" type="text/css">
    <link rel="stylesheet" href="assets/css/style.css" type="text/css">
    <link rel="stylesheet" href="assets/css/user.style.css" type="text/css">
    <title><%= title %></title>
      <style>
          @media (min-width: 767px) {#burger {visibility: hidden;}}
      </style>
</head>

<body onunload="" class="map-fullscreen page-homepage navigation-off-canvas" id="page-top">

<!-- Outer Wrapper-->
<div id="outer-wrapper">
    <!-- Inner Wrapper -->
    <div id="inner-wrapper">
        <!-- Navigation-->
        <div class="header">
            <div class="wrapper">
                <div class="brand">
                    <a href="/"><img src="assets/img/logo.png" alt="logo"></a>
                </div>
                <nav class="navigation-items">
                    <div class="wrapper">
                        <ul class="main-navigation navigation-top-header"></ul>
                        <ul class="user-area">
                            <li><a href="sign-in.html">Sign In</a></li>
                            <li><a href="register.html"><strong>Register</strong></a></li>
                            <li><a href="/about">About Us</a></li>
                        </ul>
                        <a href="./submit" class="submit-item">
                            <div class="content"><span>Submit Your Item</span></div>
                            <div class="icon">
                                <i class="fa fa-plus"></i>
                            </div>
                        </a>
                        <div class="toggle-navigation">
                            <div class="icon" id="burger">
                                <div class="line"></div>
                                <div class="line"></div>
                                <div class="line"></div>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </div>
        <!-- end Navigation-->
        <!-- Page Canvas-->
        <div id="page-canvas">
            <!--Off Canvas Navigation-->
            <nav class="off-canvas-navigation">
                <header>Navigation</header>
                <div class="main-navigation navigation-off-canvas"></div>
            </nav>
            <!--end Off Canvas Navigation-->
            <!--Page Content-->
            <div id="page-content">
            <!-- Map Canvas-->
            <div class="map-canvas list-width-30">
                <!-- Map -->
                <div class="map">
                    <div class="toggle-navigation">
                        <div class="icon">
                            <div class="line"></div>
                            <div class="line"></div>
                            <div class="line"></div>
                        </div>
                    </div>
                    <!--/.toggle-navigation-->
                    <div id="map" class="has-parallax"></div>
                    <!--/#map-->
                    <div class="search-bar horizontal">
                        <form class="main-search border-less-inputs" role="form" method="post">
                            <div class="input-row">
                                <div class="form-group">
                                    <input type="text" class="form-control" id="keyword" placeholder="Enter Keyword">
                                </div>
                                <!-- /.form-group -->
                                <div class="form-group">
                                    <div class="input-group location">
                                        <input type="text" class="form-control" id="location" placeholder="Enter Location">
                                        <span class="input-group-addon"><i class="fa fa-map-marker geolocation" data-toggle="tooltip" data-placement="bottom" title="Find my position"></i></span>
                                    </div>
                                </div>
                                <!-- /.form-group -->
                                <div class="form-group">
                                    <select name="category" multiple title="Select Category" data-live-search="true">
                                        <option value="a">Food</option>
                                        <option value="a1" class="sub-category">Halal</option>
                                        <option value="a2" class="sub-category">Non-halal</option>
                                        <option value="b">Groceries</option>
                                        <option value="b1" class="sub-category">Supermarkets</option>
                                        <option value="b2" class="sub-category">Convenience Stores</option>
                                        <option value="c">Leisure</option>
                                        <option value="c1" class="sub-category">Night Spots</option>
                                        <option value="c2" class="sub-category">Shopping Malls</option>
                                        <option value="c3" class="sub-category">Spa</option>
                                        <option value="c4" class="sub-category">Lan Shop</option>
                                        <option value="c5" class="sub-category">Gym</option>
                                        <option value="d">Medical</option>
                                        <option value="d1" class="sub-category">Hospital</option>
                                        <option value="d2" class="sub-category">General Practioners</option>
                                        <option value="d3" class="sub-category">Vieterinary Clinic</option>
                                        <option value="e">Services</option>
                                        <option value="e1" class="sub-category">Petrol Kiosks</option>
                                        <option value="e2" class="sub-category">Printing</option>
                                        <option value="e3" class="sub-category">Laundromats</option>
                                    </select>
                                </div>
                                <!-- /.form-group -->
                                <div class="form-group">
                                    <button type="submit" class="btn btn-default"><i class="fa fa-search"></i></button>
                                </div>
                                <!-- /.form-group -->
                            </div>
                            <!-- /.input-row -->
                        </form>
                        <!-- /.main-search -->
                    </div>
                    <!-- /.search-bar -->
                </div>
                <!-- end Map -->
                <!--Items List-->
                <div class="items-list">
                    <div class="inner">
                        <header>
                            <h3>Results</h3>
                        </header>
                        <ul class="results list" id="route-display">

                        </ul>
                    </div>
                    <!--results-->
                </div>
                <!--end Items List-->
            </div>
            <!-- end Map Canvas-->

            </div>
            <!-- end Page Content-->
        </div>
        <!-- end Page Canvas-->
        <!--Page Footer-->
        <footer id="page-footer">
            <div class="inner">
                <div class="footer-bottom">
                    <div class="container" align="center">
                        Â© Ginger Singapore, Inc.
                    </div>
                </div>
                <!--/.footer-bottom-->
            </div>
        </footer>
        <!--end Page Footer-->
    </div>
    <!-- end Inner Wrapper -->
</div>
<!-- end Outer Wrapper-->

<script type="text/javascript" src="assets/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript" src="assets/js/before.load.js"></script>
<script type="text/javascript" src="assets/js/jquery-migrate-1.2.1.min.js"></script>
<script type="text/javascript" src="assets/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="assets/js/smoothscroll.js"></script>
<script type="text/javascript" src="assets/js/bootstrap-select.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.hotkeys.js"></script>
<script type="text/javascript" src="assets/js/jquery.nouislider.all.min.js"></script>
<script type="text/javascript" src="assets/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script type="text/javascript" src="http://maps.google.com/maps/api/js?libraries=places"></script>
<script type="text/javascript" src="assets/js/infobox.js"></script>
<script type="text/javascript" src="assets/js/richmarker-compiled.js"></script>
<script type="text/javascript" src="assets/js/markerclusterer.js"></script>
<script type="text/javascript" src="assets/js/custom.js"></script>
<script type="text/javascript" src="assets/js/maps.js"></script>

<!--[if lte IE 9]>
<script type="text/javascript" src="assets/js/ie-scripts.js"></script>
<![endif]-->

<script>
    var _latitude = 1.36080344;
    var _longitude = 103.81565094;
    var jsonPath = '/api/listings';

    // Load JSON data and create Google Maps
    loadGoogleMap(jsonPath);

    function loadGoogleMap(jsonPath) {
    $.getJSON(jsonPath)
        .done(function(json) {
            createHomepageGoogleMap(_latitude,_longitude,json);
        })
        .fail(function( jqxhr, textStatus, error ) {
            console.log(error);
        });
    }

    // Set if language is RTL and load Owl Carousel

    $(window).load(function(){
       var rtl = true; // Use RTL
       initializeOwl(rtl);
       $(".selectpicker li").click(function(){
         setTimeout(pop, 0);
       });
    });

    autoComplete();

    function pop() {
      var elements = $( ".selectpicker li.selected" );
      var categoryArray = []
      var mainCategoryText = [];
      var typeCategoryText = [];
      elements.each(function() {
        categoryArray.push($(this).attr("rel"));
        console.log($(this))
      });

      alert("Category Array is: " + categoryArray);

      categoryArray.forEach(function(item){

          if (item == 0) {
            mainCategoryText.push("food");
          }
          else if (item == 1) {
            typeCategoryText.push("halal")
          }
          else if (item == 2) {
            typeCategoryText.push("non-halal")
          }
          else if (item == 3) {
            mainCategoryText.push("groceries")
          }
          else if (item == 4) {
            typeCategoryText.push("supermarket")
          }
          else if (item == 5) {
            typeCategoryText.push("convenience_store")
          }
          else if (item == 6) {
            mainCategoryText.push("leisure")
          }
          else if (item == 7) {
            typeCategoryText.push("night_spot")
          }
          else if (item == 8) {
            typeCategoryText.push("shopping_mall")
          }
          else if (item == 9) {
            typeCategoryText.push("spa")
          }
          else if (item == 10) {
            typeCategoryText.push("lan_shop")
          }
          else if (item == 11) {
            typeCategoryText.push("gym")
          }
          else if (item == 12) {
            mainCategoryText.push("medical")
          }
          else if (item == 13) {
            typeCategoryText.push("public_hospital")
          }
          else if (item == 14) {
            typeCategoryText.push("gp")
          }
          else if (item == 15) {
            typeCategoryText.push("veterinary_clinic")
          }
          else if (item == 16) {
            mainCategoryText.push("services")
          }
          else if (item == 17) {
            typeCategoryText.push("petrol_kiosk")
          }
          else if (item == 18) {
            typeCategoryText.push("printing")
          }
          else if (item == 19) {
            typeCategoryText.push("laundromat")
          }
        })

      alert("Min Category: " + mainCategoryText + " | Type: " + typeCategoryText);

      remap(mainCategoryText, typeCategoryText);
    }


    function remap(mainCategoryText, typeCategoryText) {
    var jsonPath = '/api/custom?mainCategory=' + mainCategoryText.join(',') + '&categoryType=' + typeCategoryText.join(',')
    console.log(jsonPath)
  }

    function remap() {
    var jsonPath = '/api/listings'
    loadGoogleMap(jsonPath);
    }



</script>

<!--[if lte IE 9]>
<script type="text/javascript" src="assets/js/ie-scripts.js"></script>
<![endif]-->
</body>
</html>
